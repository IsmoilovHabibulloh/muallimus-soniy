{"id":"ms-1ty","title":"Mad qoidasi: 19-21 sahifalar uchun harakat belgilarini qayta tahrirlash","description":"## Tavsif\n\nTajvid ilmidagi **mad qoidasi** bo'yicha 19-20 va 21-sahifaning boshidagi arabcha so'zlardagi harakat belgilarini to'g'ri ko'rsatish kerak.\n\n### Qoidalar:\n1. **Fatha va kasra** — mad bo'lgan joylarda yonboshlatilmay, **tikka (vertikal)** yozilishi kerak.\n2. **Zamma** — mad bo'lgan joylarda oddiy zammadan **kattaroq va yo'g'onroq** yozilishi kerak.\n3. **Mad bo'lmagan joylarda** bu qoidalar qo'llanilMASligi kerak — oddiy harakat belgilari saqlanadi.\n\n### Mad qachon bo'ladi:\n- ا (alif) oldidan **fatha** kelganda → choʻzib oʻqiladi (masalan: قَالَ)\n- و (vov) oldidan **zamma** kelganda → choʻzib oʻqiladi (masalan: يَقُولُ)\n- ي (ya) oldidan **kasra** kelganda → choʻzib oʻqiladi\n\n### Qamrov:\nFaqat **19, 20 va 21-sahifaning boshi** — boshqa sahifalarga tegmaydi.\n\n### Muhim kontekst (17-18 sahifalardan reference):\n- 17-18 sahifalarda BARCHA so'zlar madli, shuning uchun isMadd: true butun sectionga qo'yilganida to'g'ri ishlagan.\n- 19-21 sahifalarda esa bitta qator ichida ham madli, ham madsiz so'zlar bor → isMadd flag section darajasida emas, HAR BIR SO'Z darajasida tekshirilishi kerak.\n- _buildMaddText funksiyasi (line 2579) reference sifatida 17-18 sahifalarda yaxshi ishlaydi.\n- Muammo: lesson5_, lesson6_, lesson7_ sectionlari madd_word_row turiga tushadi va isMadd: true global qo'yiladi → madsiz so'zlar ham noto'g'ri renderlanadi.\n\n---\n\n## Acceptance Criteria\n\n1. 19-20 va 21-sahifa boshidagi mad pozitsiyalaridagi **fatha va kasra** belgilari tikka (vertikal) ko'rinishda renderlanadi.\n2. Mad pozitsiyalaridagi **zamma** belgilari oddiy zammadan kattaroq va yo'g'onroq renderlanadi.\n3. Mad bo'lmagan joylardagi harakat belgilari o'zgarmagan holda qoladi (oddiy yonbosh fatha/kasra, oddiy zamma).\n4. Boshqa sahifalarga (1-18, 21 oxiri - oxirigacha) hech qanday o'zgartirish kirmaydi.\n5. 17-18 sahifalar avvalgidek to'g'ri ishlashda davom etadi (regression yo'q).\n\n---\n\n## Steps to Solve\n\n1. _buildMaddText funksiyasini o'zgartirish — har bir so'zni individual tekshirish: so'z ichida mad harf (ا، و، ي) oldida mos harakat bor-yo'qligini aniqlash.\n2. isMadd flagni section darajasida emas, so'z darajasida logika qilish.\n3. Zamma uchun maxsus rendering qo'shish (kattaroq va yo'g'onroq ko'rinish).\n4. 17-18 va 19-21 sahifalarni test qilish.\n\n---\n\n## File List to Review\n\n- frontend/lib/presentation/screens/reader/native_page_renderer.dart — _TableRow, _buildMaddText, _buildCell funksiyalari","status":"closed","priority":1,"issue_type":"task","owner":"96883902+Ismiolov@users.noreply.github.com","created_at":"2026-02-16T22:40:34Z","created_by":"Habibulloh Ismoilov","updated_at":"2026-02-17T17:40:50Z","closed_at":"2026-02-17T17:40:50Z","close_reason":"Closed","labels":["enhancement"],"comments":[{"id":1,"issue_id":"ms-1ty","author":"Habibulloh Ismoilov","text":"## Qo'shimcha kontekst (Reference)\n\n**17-18 sahifalar** — bu yerda 1-2 qoidalar (tikka fatha/kasra, katta zamma) allaqachon to'g'ri ishlayapti. Sababi: 17-18 sahifalardagi **barcha so'zlar madli**, shuning uchun harakat belgilari bir xil stilda renderlanadi va muammo yo'q.\n\n**19-20-21 sahifalarda** esa muammo bor: bitta sahifada **ham madli, ham madsiz so'zlar** aralash keladi. Hozirgi kod barcha harakatlarni bir xil stilga solayapti — ya hammasi madli renderlanyapti yoki hammasi oddiy. Bu xato.\n\n### Xulosa:\n- 17-18 sahifalar **reference (namuna)** sifatida ishlatilsin — u yerda qoidalar to'g'ri ishlayapti\n- 19-20-21 sahifalarda **har bir so'z alohida tekshirilishi** kerak: mad bormi yoki yo'qmi\n- Mad bor so'zlarda → tikka fatha/kasra + katta zamma\n- Mad yo'q so'zlarda → oddiy harakat belgilari","created_at":"2026-02-16T22:49:24Z"},{"id":2,"issue_id":"ms-1ty","author":"Habibulloh Ismoilov","text":"## Muhim aniqlik (Yangilangan talab)\n\nAvvalgi tavsifda \"har bir so'zni tekshirish\" deyilgan edi — bu yetarli emas.\n\n### Aniq qoida:\n- Tekshirish **so'z darajasida emas**, **har bir harakat belgisi darajasida** bo'lishi kerak\n- **Bitta so'z ichida** ham madli fatha, ham madsiz fatha bo'lishi mumkin (kasra, zamma ham xuddi shunday)\n- Har bir harakat belgisi uchun: keyingi harf mad harfimi (ا، و، ي) tekshiriladi\n  - **Ha** → madli rendering (tikka fatha/kasra, katta zamma)\n  - **Yo'q** → oddiy rendering\n\n### Misol:\nAgar so'zda 2 ta fatha bo'lsa:\n- 1-fatha → keyingi harf ا (mad) → **tikka fatha** bilan renderlanadi\n- 2-fatha → keyingi harf ب (mad emas) → **oddiy fatha** bilan renderlanadi\n\n### Xulosa:\nTizim har bir harakatni alohida tahlil qilishi kerak — character-by-character analysis.","created_at":"2026-02-17T17:12:02Z"}]}
{"id":"ms-23f","title":"Deploy Infrastructure","description":"Docker Compose: API, Worker, PostgreSQL, Redis. System Nginx: SSL (Lets Encrypt), proxy 8001. Domain: ikkinchimuallim.codingtech.uz. Server IPv4: 46.224.135.238. SSH: root@46.224.135.238 (parol: codingtech2204). Demo: demobaza.codingtech.uz. Backup/restore scripts.","status":"closed","priority":0,"issue_type":"task","owner":"96883902+Ismiolov@users.noreply.github.com","created_at":"2026-02-16T22:06:24Z","created_by":"Habibulloh Ismoilov","updated_at":"2026-02-16T22:11:25Z","closed_at":"2026-02-16T22:06:41Z","close_reason":"Docker+Nginx+SSL deploy ishlayapti"}
{"id":"ms-3yp","title":"Rename: Muallimus Soniy \u003e Muallimi Soniy","description":"46 fayl yangilandi. GitHub repo nomi. DB: muallimus_soniy\u003emuallimi_soniy. Flutter class. Android package. Server env vars.","status":"closed","priority":1,"issue_type":"task","owner":"96883902+Ismiolov@users.noreply.github.com","created_at":"2026-02-16T22:06:24Z","created_by":"Habibulloh Ismoilov","updated_at":"2026-02-16T22:06:42Z","closed_at":"2026-02-16T22:06:42Z","close_reason":"46 faylda rename qilingan, GitHub repo yangilangan"}
{"id":"ms-3zs","title":"Admin Panel SPA","description":"Vanilla JS admin panel. Login: admin/JWT. Sahifalarni CRUD, versioning. Blog/Team. Accounts jadvali: saralash, filtrlash, Telegram login. URL: /admin/","status":"closed","priority":1,"issue_type":"task","owner":"96883902+Ismiolov@users.noreply.github.com","created_at":"2026-02-16T22:06:24Z","created_by":"Habibulloh Ismoilov","updated_at":"2026-02-16T22:06:41Z","closed_at":"2026-02-16T22:06:41Z","close_reason":"Admin panel to'liq funksional"}
{"id":"ms-46d","title":"Android App Build (Play Store)","description":"Flutter Android platform. Release AAB. Keystore. Package: uz.codingtech.muallimi_soniy. Play Store listing: tavsif, maxfiylik siyosati, foydalanish shartlari.","status":"closed","priority":1,"issue_type":"task","owner":"96883902+Ismiolov@users.noreply.github.com","created_at":"2026-02-16T22:06:24Z","created_by":"Habibulloh Ismoilov","updated_at":"2026-02-16T22:06:41Z","closed_at":"2026-02-16T22:06:41Z","close_reason":"AAB build tayyor, Play Store listing qilingan"}
{"id":"ms-4nx","title":"Server Deploy v1.0.2","description":"Repo serverda klonlandi. Docker images rebuild. PostgreSQL: muallimi user, muallimi_soniy DB. Eski DBdan 47 sahifa, 2468 text unit tiklandi. HTTPS: ikkinchimuallim.codingtech.uz OK.","status":"closed","priority":0,"issue_type":"task","owner":"96883902+Ismiolov@users.noreply.github.com","created_at":"2026-02-16T22:06:25Z","created_by":"Habibulloh Ismoilov","updated_at":"2026-02-16T22:06:42Z","closed_at":"2026-02-16T22:06:42Z","close_reason":"v1.0.2 serverda ishlayapti, 47 sahifa tiklangan"}
{"id":"ms-5ok","title":"Audio integratsiya: sahifa audiolarini unitlarga bog'lash","description":"Har bir sahifaga audio yuklanadi (1 ta audio = 1 yoki bir nechta sahifa). Audio avtomatik ravishda har bir text_unit ga moslab qirqiladi. Yozuv ustiga bosganda aynan shu unitga tegishli audio ijro etiladi.\n\n## Acceptance Criteria\n1. Admin paneldan sahifaga audio yuklash mumkin (1 audio = 1+ sahifa)\n2. Backend audio faylni avtomatik unitlarga moslab qirqadi (segmentatsiya)\n3. Har bir text_unit ga audio_start_ms va audio_end_ms bog'lanadi\n4. Frontendda unit ustiga bosganda tegishli audio segment ijro etiladi\n5. Arabcha harflar/suzlar/matnlar audiolari barcha tillar uchun bir xil\n6. Uzbekcha tarjima matnlari audiolari faqat uz_latin va uz_cyrl uchun amal qiladi\n7. Keyinchalik en/ru/ar tarjima audiolari alohida yuklanadi\n\n## Steps to Solve\n1. Backend: Audio upload endpoint (admin) - sahifa/sahifalar uchun audio qabul qilish\n2. Backend: Audio segmentatsiya service - audio ni unitlarga moslab qirqish (ffmpeg/pydub)\n3. Backend: text_units jadvaliga audio_start_ms, audio_end_ms, audio_file_id ustunlari qushish\n4. Backend: Audio serve endpoint - segment audio ni stream qilish\n5. Frontend: AudioPlayer widget - unit bosilganda audio ijro etish\n6. Frontend: Til filtri - tarjima audiolari faqat uz_latin/uz_cyrl da ishlashi\n7. Admin: Audio upload UI - sahifa tanlash va audio yuklash interfeysi\n\n## File List to Review\n- backend/app/models/book.py (text_units, audio_files models)\n- backend/app/api/v1/admin/audio.py (upload endpoint)\n- backend/app/services/audio.py (segmentatsiya logic)\n- frontend/lib/presentation/screens/reader/reader_screen.dart (audio player)\n- frontend/lib/presentation/widgets/audio_unit_player.dart (yangi widget)\n- admin/dist/index.html (audio upload UI)","acceptance_criteria":"1. Audio yuklab unitlarga boglanadi 2. Unit bosilganda audio ijro etiladi 3. Arab audio=barcha til, uzbek tarjima audio=faqat uz","status":"open","priority":0,"issue_type":"feature","owner":"96883902+Ismiolov@users.noreply.github.com","created_at":"2026-02-16T22:25:36Z","created_by":"Habibulloh Ismoilov","updated_at":"2026-02-16T22:25:36Z"}
{"id":"ms-af7","title":"Kitob Raqamlashtirish (47 sahifa)","description":"Ahmad Xodiy Maqsudiy kitobining 47 sahifasi raqamlashtirildi. 2468 text_unit. Native page renderer (Flutter). seed_book_data.py. OCR: Tesseract+Arabic. Sahifa 19 maxsus tuzatildi (sukun vs tanvin).","status":"closed","priority":0,"issue_type":"task","owner":"96883902+Ismiolov@users.noreply.github.com","created_at":"2026-02-16T22:06:24Z","created_by":"Habibulloh Ismoilov","updated_at":"2026-02-16T22:06:41Z","closed_at":"2026-02-16T22:06:41Z","close_reason":"47 sahifa, 2468 text unit to'liq raqamlashtirilgan"}
{"id":"ms-bbu","title":"Suralarni to'g'ri unitlarga bo'lish — har bir oyat = 1 unit","description":"## Acceptance Criteria\n1. Har bir Qur'on oyati bitta alohida unit sifatida saqlanadi\n2. Hech bir oyat ikki unitga bo'linmaydi (avzast ko'chirilmaydi)\n3. Oyat raqamlari to'g'ri joyda turadi (har bir oyat oxirida)\n4. Bismilloh alohida unit sifatida saqlanadi\n5. Sura sarlavhasi alohida unit sifatida saqlanadi\n6. Barcha sura sahifalari tekshiriladi va tuzatiladi\n\n## Steps to Solve\n1. Barcha sura sahifalarini aniqlash (DB dan sura_* section li sahifalarni topish)\n2. Har bir sahifadagi unitlarni tekshirish — oyat raqamlari bilan solishtirish\n3. Noto'g'ri bo'lingan oyatlarni birlashtirish yoki qayta bo'lish\n4. Admin API orqali unitlarni yangilash (PUT /pages/{id}/units/bulk)\n5. Har bir sahifani brauzerda tekshirish\n\n## File List to Review\n- backend/app/api/v1/admin/book.py (bulk update endpoint)\n- backend/app/models/text_unit.py (TextUnit model)\n- frontend/lib/presentation/screens/reader/native_page_renderer.dart (ayat rendering)","status":"closed","priority":2,"issue_type":"task","owner":"96883902+Ismiolov@users.noreply.github.com","created_at":"2026-02-17T21:03:08Z","created_by":"Habibulloh Ismoilov","updated_at":"2026-02-17T23:18:12Z","closed_at":"2026-02-17T23:18:12Z","close_reason":"Closed"}
{"id":"ms-e61","title":"Harflar sarlavhalarida positional shakllarni qayta tiklash","description":"## Acceptance Criteria\n\n1. Har bir harf bo'limi sarlavhasida harf uchta shaklda ko'rsatilishi kerak:\n   - So'z boshida kelgan shakli + fatha (masalan: بـَ)\n   - So'z o'rtasida kelgan shakli + kasra (masalan: ـبـِ)\n   - So'z oxirida kelgan shakli + damma (masalan: ـبُ)\n2. Yopishmagan harflar (ا, د, ذ, ر, ز, و) uchun so'z boshi va o'rtasi shakli bir xil bo'lishi mumkin, so'z oxirida boshqacha (yopishmagan) shaklda kelishi kerak.\n3. Barcha 27 ta harf bo'limi sarlavhasi to'g'rilangan bo'lishi kerak.\n4. Sahifalar 3-16 da barcha header unitlar yangilangan bo'lishi kerak.\n\n## Steps to Solve\n\n1. seed_book_data.py faylida barcha _header turidagi unitlarni topish\n2. Har bir harf uchun to'g'ri positional shakllarni aniqlash:\n   - Yopishuvchi harflar: boshlanish shakli (tatweel bilan), o'rta shakli, oxirgi shakli\n   - Yopishmagan harflar: boshi/o'rtasi bir xil, oxiri ajralgan holda\n3. seed_book_data.py dagi barcha header qatorlarini yangilash\n4. Bazada (database) mavjud unitlarni yangilash uchun migration script yozish yoki seed qayta ishga tushirish\n5. Web frontend ni qayta build qilish va tekshirish\n\n## File List to Review\n\n- backend/app/seed_book_data.py (header qatorlarini o'zgartirish)\n- backend/app/seed_book.py (seed mexanizmi)\n- frontend/lib/presentation/screens/reader/native_page_renderer.dart (_TitleUnit widget)","status":"closed","priority":1,"issue_type":"task","owner":"96883902+Ismiolov@users.noreply.github.com","created_at":"2026-02-17T23:40:20Z","created_by":"Habibulloh Ismoilov","updated_at":"2026-02-18T00:11:44Z","closed_at":"2026-02-18T00:11:44Z","close_reason":"Closed","labels":["task"]}
{"id":"ms-ek2","title":"Loyiha Arxitekturasi","description":"Backend: FastAPI+PostgreSQL+Redis+Celery (Docker Compose). Frontend: Flutter (iOS/Android/Web). Admin: Vanilla JS SPA. Deploy: Docker+Nginx+SSL. Server: ikkinchimuallim.codingtech.uz. GitHub: github.com/IsmoilovHabibulloh/muallimi-soniy","status":"closed","priority":0,"issue_type":"epic","owner":"96883902+Ismiolov@users.noreply.github.com","created_at":"2026-02-16T22:06:23Z","created_by":"Habibulloh Ismoilov","updated_at":"2026-02-16T22:06:41Z","closed_at":"2026-02-16T22:06:41Z","close_reason":"Arxitektura to'liq tuzilib, production'da ishlayapti"}
{"id":"ms-ess","title":"Kalimalarni to'g'ri unitlarga bo'lish — sarlavha 1 unit, matn 1 unit","description":"## Acceptance Criteria\n\n1. Har bir kalima sarlavhasi (masalan كلمة طيبة, كلمة الشهادة) alohida 1 ta unit — **DONE ✅**\n2. Har bir kalima matni yaxlit 1 ta unit sifatida saqlanadi — qatorlarga bo'linmaydi — **DONE ✅**\n3. Kalima matnlari asl nusxa bilan 100% mos — har bir so'z, harakat tekshirilgan — **DONE ✅**\n4. Sort_order lardagi bo'shliqlarni tekislash (hozir 7,8,11 skip bo'lgan)\n5. Divider/separator lar ortiqcha bo'shliq yaratmasligi — asl nusxadagi kabi yaqinroq joylashish\n6. Asl nusxadagi ornamental belgilar (❁) kalima sarlavhalaridan oldin va keyin to'g'ri ko'rsatilishi\n7. UX asl nusxa kitobdagi kabi kompakt va sifatli bo'lishi — Ultra UI darajasida\n8. UI da hech qanday buzilish bo'lmasligi — boshqa sahifalarga ta'sir qilmasligi\n\n## Steps to Solve\n\n1. **Diagnostic**: Sort_order bo'shliqlarini aniqlash va tekislash (Python skript)\n2. **Frontend tuning**: _DuaSection widgetida spacing, padding, font-size ni asl nusxaga moslashtirish\n3. **Ornamental belgilar**: Kalima sarlavha va matn orasidagi ❁ belgilarni to'g'ri render qilish\n4. **Divider optimization**: Kalima sectionlari orasidagi separatorlarni kamroq bo'shliq bilan ko'rsatish\n5. **Asl nusxa bilan solishtirish**: Brauzerda 34-35 sahifalarni asl nusxa rasmlari bilan pixel-by-pixel solishtirish\n6. **Build \u0026 Deploy**: Flutter web build, deploy, brauzerda final tekshiruv\n\n## File List to Review\n\n- frontend/lib/presentation/screens/reader/native_page_renderer.dart (_DuaSection, _TitleUnit widgetlari)\n- backend/app/models/book.py (TextUnit, sort_order)\n- backend/app/api/v1/admin/book.py (bulk_update_units endpoint)\n- Materiallar/kalimalarning asl nusxalari/34.jpg (asl nusxa)\n- Materiallar/kalimalarning asl nusxalari/35.jpg (asl nusxa)\n\n## Reference\n\nAsl nusxa rasmlari: Materiallar/kalimalarning asl nusxalari/ papkasida\nSahifa 34: كلمات إيمان — 6 ta kalima (tayyiba, shahada, tawhid, radd, istighfar)\nSahifa 35: istighfar davomi, tamjid, mashiatullah, iman tarifi, mujmal, mufassal","status":"closed","priority":2,"issue_type":"task","owner":"96883902+Ismiolov@users.noreply.github.com","created_at":"2026-02-17T21:05:19Z","created_by":"Habibulloh Ismoilov","updated_at":"2026-02-21T19:23:55Z","closed_at":"2026-02-21T19:23:55Z","close_reason":"Closed"}
{"id":"ms-lk9","title":"Page Versioning API","description":"Publish qilganda version snapshot. Versiyalar royxati va rollback endpointlari. Admin UI: versiya tarixi va rollback. page_versions jadvali.","status":"closed","priority":1,"issue_type":"task","owner":"96883902+Ismiolov@users.noreply.github.com","created_at":"2026-02-16T22:06:24Z","created_by":"Habibulloh Ismoilov","updated_at":"2026-02-16T22:06:42Z","closed_at":"2026-02-16T22:06:42Z","close_reason":"Versioning API va admin UI tayyor"}
{"id":"ms-urz","title":"Deep linking: barcha sahifa va bo'limlarga alohida URL marshrutlar qo'shish","description":"## Maqsad\nKelajakda mundarija (table of contents) qo'shilganda, har bir sahifa va bo'limga to'g'ridan-to'g'ri o'tish imkoniyati bo'lishi kerak. Buning uchun ilovadagi barcha asosiy ekranlar va bo'limlarga alohida URL marshrutlar (deep links) tayinlanishi kerak.\n\n## Acceptance Criteria\n1. Har bir reader sahifasi alohida URL orqali ochiladi: `/#/reader/{page_number}`\n2. Sozlamalar sahifasining har bir bo'limi alohida URL ga ega: `/#/settings/theme`, `/#/settings/font`, `/#/settings/language` va h.k.\n3. Fikr bildirish sahifasi alohida URL: `/#/feedback`\n4. Bosh sahifa: `/#/home`\n5. Brauzer `back/forward` tugmalari to'g'ri ishlaydi\n6. URL ni to'g'ridan-to'g'ri brauzer address bar ga yozib ochganda kerakli sahifa ochiladi\n7. Mundarija uchun tayyor bo'lgan linklar tuzilmasi mavjud\n\n## Steps to Solve\n1. Mavjud routing tuzilmasini o'rganish (GoRouter yoki Navigator 2.0)\n2. Barcha ekranlar va bo'limlarning ro'yxatini tuzish\n3. Har bir ekran uchun URL pattern belgilash\n4. Router konfiguratsiyasini yangilash\n5. Reader sahifasida sahifa raqamini URL dan olish va sahifaga o'tish\n6. Sozlamalar sahifasida har bir bo'limga alohida route qo'shish\n7. Fikr bildirish sahifasiga route qo'shish\n8. Browser back/forward navigatsiyasini tekshirish\n9. URL dan to'g'ridan to'g'ri ochilishni (deep linking) tekshirish\n10. Build va deploy\n\n## File List to Review\n- `frontend/lib/main.dart` — app entry point, router setup\n- `frontend/lib/presentation/screens/` — barcha screen fayllar\n- `frontend/lib/presentation/screens/reader/` — reader screen\n- `frontend/lib/presentation/screens/settings/` — sozlamalar\n- `frontend/pubspec.yaml` — router package dependency","status":"closed","priority":2,"issue_type":"task","owner":"96883902+Ismiolov@users.noreply.github.com","created_at":"2026-02-17T17:45:00Z","created_by":"Habibulloh Ismoilov","updated_at":"2026-02-17T21:11:47Z","closed_at":"2026-02-17T21:11:47Z","close_reason":"Closed","labels":["feature"]}
{"id":"ms-wxd","title":"Deep linking va sarlavha UI yangilash","status":"closed","priority":2,"issue_type":"task","owner":"96883902+Ismiolov@users.noreply.github.com","created_at":"2026-02-17T20:27:07Z","created_by":"Habibulloh Ismoilov","updated_at":"2026-02-18T00:14:21Z","closed_at":"2026-02-18T00:14:21Z","close_reason":"Closed"}
